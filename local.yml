- hosts: localhost
  connection: local
  become: true

  tasks:
    - name: Install packages for apt package manager
      package:
        name: "{{ item }}"
        state: present
      loop:
        - htop
        - tmux
        - python3-psutil
        - neovim
        - dconf
        - wireshark-qt
        - macchanger
        - binwalk
        - npm
        - gcc
        - ripgrep
      when: ansible_facts.pkg_mgr == 'apt'
      become: true

    - name: Install packages for yum package manager
      package:
        name: "{{ item }}"
        state: present
      loop:
        - htop
        - tmux
        - python3-psutil
        - neovim
        - dconf
        - wireshark-qt
        - macchanger
        - binwalk
        - npm
        - gcc
        - ripgrep
      when: ansible_facts.pkg_mgr == 'yum'
      become: true

    - name: Install packages for dnf package manager
      package:
        name: "{{ item }}"
        state: present
      loop:
        - htop
        - tmux
        - python3-psutil
        - neovim
        - dconf
        - wireshark-qt
        - macchanger
        - binwalk
        - npm
        - gcc
        - ripgrep
      when: ansible_facts.pkg_mgr == 'dnf'
      become: true

# Remaining tasks for copying wallpaper and setting wallpaper
- name: Copy wallpaper file
   copy: 
     src: files/wallpaper.png
    dest: /usr/share/backgrounds/ansible-wallpaper.png
   become: yes
   become_user: root

- name: Set wallpaper
   become_user: james
  dconf: 
     key: "/org/gnome/desktop/background/picture-uri"
     value: "'file:///usr/share/backgrounds/ansible-wallpaper.png'"

- name: Set wallpaper position
   become_user: james
  dconf:
    key: "/org/gnome/desktop/background/picture-options"
    value: "'zoom'"

